jQuery(document).ready(function(T){"use strict";function n(){T("body .tpl-dt-select").each(function(){T(this).has(".select2").length<1&&!T(this).hasClass("no-select2")&&!T(this).parents("#tpl_repeater_bank").length&&(T(this).is(".tpl-dt-font_awesome")?T(this).find("select").select2(i):T(this).find("select").select2(e))})}function t(t){return t.text}function s(){T("body .tpl-field.tpl-dt-tinymce").not(T("body .tpl-field.tpl-dt-tinymce.tpl-admin-hide")).each(function(){var t=T(this).find("textarea").attr("id");tinyMCE.execCommand("mceAddEditor",!1,t)}),T("body .tpl-field.tpl-dt-tinymce.tpl-admin-hide").each(function(){var t=T(this).find("textarea").attr("id");tinyMCE.execCommand("mceRemoveEditor",!1,t)})}function l(){T(".tpl-repeat").each(function(){T(this).parent().addClass("tpl-repeater")||T(this).parent().addClass("tpl-repeater")}),void 0!==T.ui.sortable&&T(".tpl-repeater").sortable({handle:".tpl-arranger",items:".tpl-repeat",update:function(t,e){o(T(this))},start:function(t,e){e.placeholder.height(e.item.height()),e.item.closest(".tpl-repeater").find(".tpl-field.tpl-dt-tinymce textarea").each(function(){var t=T(this).attr("id");tinyMCE.execCommand("mceRemoveEditor",!1,t)})},stop:function(t,e){s()}})}function o(t){var d=window.location.href,p=[];p[0]=0;t.find(".tpl-field").each(function(){var t=parseInt(T(this).attr("data-level")),a=T(this).attr("data-name").split("/");if(0<t)for(var e=0;e<t;e++){for(var i="",n=0;n<=e;n++)i+=a[n],n<e&&(i+="/");p[e]=parseInt(T(this).parents('.tpl-field[data-name="'+i+'"]').last().attr("data-instance"))}var s,l=parseInt(T(this).prev('.tpl-field[data-name="'+T(this).attr("data-name")+'"]').attr("data-instance"));if(s=l,!isNaN(parseFloat(s))&&isFinite(s)?p[t]=l+1:p[t]=0,T(this).attr("data-instance",p[t]),T(this).find(".tpl-header-title-instance").html("(#"+p[t]+")"),0==t)for(var o=1;o<p.length;o++)p[o]=0;T("input, select, textarea",this).each(function(){if(tpl_fw.is_section_primary())var t=T(this).closest(".tpl_settings_page_wrap").attr("data-name");else t=a[0];if(void 0!==t){for(var e=t,i=0;i<a.length;i++)i<a.length-1||1==a.length?(-1<d.indexOf("post.php")||-1<d.indexOf("post-new.php"))&&0==i?e+="["+p[i]+"]":e+="["+a[i]+"]["+p[i]+"]":T(this).closest(".tpl-field").hasClass("tpl-repeat")?e+="["+a[i]+"]["+p[i]+"]":e+="["+a[i]+"]";T(this).attr("name",e),T(this).attr("id",e),T(this).closest(".tpl-field").prevAll("label").attr("for",e)}})})}function a(t){return"tpl-dt-"+t.attr("data-type")}function d(t){var e="";if(void 0!==t.attr("data-preview-value"))e=t.attr("data-preview-value");else switch(t.prop("tagName").toLowerCase()){case"select":e=t.closest(".tpl-dt-select").is(".tpl-select-preview-key")?t.val():t.closest(".tpl-dt-select").find(".select2-selection__rendered").html();break;case"span":e=t.html();break;case"textarea":var i=t.val(),a=document.createElement("div");a.innerHTML=i,e=a.textContent||a.innerText||"";break;case"img":e=t.attr("src");break;default:e=t.val()}return e}function p(t){t=t.split("/");for(var e="",i=0;i<t.length-1;i++)e+=t[i],i<t.length-2&&(e+="/");return e}function r(){T(".tpl-repeat").each(function(){var s="",e="",l="",o=this;if(e=void 0!==TPL_Admin[T(this).attr("data-name")+"_preview-template"]?T(this).attr("data-name")+"_preview-template":a(T(this))+"_preview-template",T(this).is(".tpl-dt-combined"))if(void 0!==TPL_Admin[e]){var t=(s=TPL_Admin[e]).match(/\[.*?tpl-preview-\w*\]/g);T(".tpl-field",this).each(function(){var a=(l=T(this).attr("data-name")).split("/"),n=this;T.each(t,function(t,e){var i=e.split("/tpl-preview-");i[0]=a[0]+"/"+i[0].substring(1),i[1]=i[1].slice(0,-1),T("*[data-preview]",n).each(function(){i[0]==l&&T(this).attr("data-preview")==i[1]&&(s=-1<p(l).search("/")&&T('[data-name="'+p(l)+'"]').is(".tpl-repeat")&&T(this).closest('[data-name="'+p(l)+'"]').parent().find('[data-name="'+p(l)+'"]').length>parseInt(T(this).closest('[data-name="'+p(l)+'"]').attr("data-instance"))+1&&parseInt(T(n).attr("data-level"))<3&&T(o).is(".tpl-preview-multi")?s.replace(e,d(T(this)))+" / "+e:s.replace(e,d(T(this))))})})}),T.each(t,function(t,e){s=s.replace(e,"")})}else{var i=T(".tpl-field",this).length;T(".tpl-field",this).each(function(t){l=T(this).attr("data-name"),e=a(T(this))+"_preview-template",void 0!==TPL_Admin[e]?(s+=TPL_Admin[e],T("*[data-preview]",this).each(function(){var t=T(this).attr("data-preview");s=s.replace("[tpl-preview-"+t+"]",d(T(this)))})):T("*[data-preview]",this).each(function(){s+=d(T(this))}),t<i-1&&(s+=" / ")})}else void 0!==TPL_Admin[e]?(s=TPL_Admin[e],T("*[data-preview]",this).each(function(){var t=T(this).attr("data-preview");-1<s.indexOf("[tpl-preview-"+t+"]")&&(s=s.replace("[tpl-preview-"+t+"]",d(T(this))))})):T("*[data-preview]",this).each(function(){T(this).attr("data-preview");s+=d(T(this))});T(".tpl-header-title-preview",this).html(s)})}function P(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function L(){var t,e;return e=null,t=T("body").attr("class").split(" "),T(t).each(function(){"post-type-"!==this.substr(0,10)||(e=(e=this.split("post-type-"))[e.length-1])}),e}function c(){var k=window.location.href;T("body .tpl-field, body .tpl-meta-option").each(function(){if(-1<k.indexOf("themes.php")||-1<k.indexOf("options-general.php")||-1<k.indexOf("admin.php"))var t=P("page",k).replace("-","_"),e="tr";if(-1<k.indexOf("post.php")||-1<k.indexOf("post-new.php"))t="",e=".tpl-meta-option";var i=T(this).attr("data-name"),a=T(this).attr("data-connected"),n=T(this).attr("data-instance");if(T(this).hasClass("tpl-meta-option")&&(i=a),tpl_fw.is_section_primary()&&!T(this).hasClass("tpl-subitem")&&T(this).closest(e).attr("data-connected",a),""==t&&(t=T(this).closest(".postbox").attr("id")),void 0!==TPL_Admin.Conditions&&void 0!==TPL_Admin.Conditions[i]){var s,l=Object.keys(TPL_Admin.Conditions[i]).length,o=[];for(s=0;s<l;s++)if(void 0!==TPL_Admin.Conditions[i][s]){var d=TPL_Admin.Conditions[i][s].type,p=TPL_Admin.Conditions[i][s].name,r=TPL_Admin.Conditions[i][s].relation,c=TPL_Admin.Conditions[i][s].value,h="",f="",m=[],u=[],v=[];if("option"==d){if(-1<p.indexOf("/"))if(m=p.split("/"),v=i.split("/"),"_THIS_"==m[0]){for(var g=0;g<v.length-1;g++){u[2*g]=v[g];for(var _="",w=0;w<=g;w++)_+=v[w],w<g&&(_+="/");u[2*g+1]=T(this).closest('.tpl-field[data-name="'+_+'"]').attr("data-instance")}u.push(m[m.length-1])}else u=m;else u[0]=p,u[1]=0;h=-1<k.indexOf("post.php")||-1<k.indexOf("post-new.php")?"#"+u[0]:"#"+t;for(var b=0;b<u.length;b++)-1<k.indexOf("post.php")||-1<k.indexOf("post-new.php")?0<b&&(h+="\\["+u[b]+"\\]"):h+="\\["+u[b]+"\\]";f=T(h).val()}if("post"==d&&("type"==p&&(f=L()),"id"==p&&(f=P("post",k))),"page"==d&&"template"==p&&(f=T("#page_template").val()),"taxonomy"==d)if("post_format"==p)T("#post-formats-select input").each(function(){T(this).is(":checked")&&(f=T(this).attr("id").replace("post-format-",""))});else{f=[];var y=0;T("#"+p+"checklist li").each(function(){y=T(this).attr("id").replace(p+"-",""),T("input",this).is(":checked")&&f.push(y)})}switch(r){case"=":T.isArray(f)?-1<T.inArray(c,f)?o.push(!0):o.push(!1):f==c?o.push(!0):o.push(!1);break;case"!=":T.isArray(f)?T.inArray(c,f)<0?o.push(!0):o.push(!1):f!=c?o.push(!0):o.push(!1);break;case"<":f<c?o.push(!0):o.push(!1);break;case">":c<f?o.push(!0):o.push(!1)}}var x=!1,C="and";if(void 0!==TPL_Admin.Conditions[i].logic)C=TPL_Admin.Conditions[i].logic;"and"==C&&T.inArray(!1,o)<0&&(x=!0),"or"==C&&-1<T.inArray(!0,o)&&(x=!0),a=a.replace("/","/");var A="";T(this).is(".tpl-subitem")&&T(this).closest(".tpl-dt-combined").is(".tpl-repeat")&&(A='[data-instance="'+n+'"]'),1==x?void 0!==a&&(T('[data-connected="'+a+'"]'+A).removeClass("tpl-admin-hide"),T(this).find("input, select, textarea").each(function(){T(this).attr("name",T(this).attr("id"))})):void 0!==a&&(T('[data-connected="'+a+'"]'+A).addClass("tpl-admin-hide"),T(this).find("input, select, textarea").removeAttr("name"),T(this).closest(e).find(".tpl-field.tpl-dt-tinymce.tpl-admin-hide textarea").each(function(){var t=T(this).attr("id");tinymce.execCommand("mceRemoveEditor",!1,t)}))}}),T(".postbox").each(function(){var t=[];T(".tpl-meta-option",this).each(function(){T(this).hasClass("tpl-admin-hide")?t.push(!0):t.push(!1)}),-1<T.inArray(!0,t)&&T.inArray(!1,t)<0?T(this).addClass("tpl-admin-hide"):T(this).removeClass("tpl-admin-hide")})}var h;TPL_Admin.basic_select2_settings={escapeMarkup:function(t){return t},width:"100%"};var e=T.extend({minimumResultsForSearch:10},TPL_Admin.basic_select2_settings),i=T.extend({templateSelection:t,templateResult:t,formatSelection:t,formatResult:t,minimumResultsForSearch:10},TPL_Admin.basic_select2_settings);l(),T("#wp-dummy_editor-wrap").remove(),T("body").on("click",".tpl-uploader .button, .tpl-uploader .tpl-uploaded-image, .tpl-img-placeholder",function(t){t.preventDefault();var e=T(this).parent().find(".tpl-uploaded-image"),i=e.closest(".tpl-field");(h=wp.media.frames.file_frame=wp.media({title:TPL_Admin.uploader_title,button:{text:TPL_Admin.uploader_button},multiple:!1})).on("select",function(){var t=h.state().get("selection").first().toJSON();void 0!==t.sizes.thumbnail?e.attr("src",t.sizes.thumbnail.url):e.attr("src",t.sizes.full.url),e.show(),i.find(".tpl-img_id").val(t.id).trigger("change"),i.find(".tpl-img-placeholder").hide(),i.find(".tpl-closer").show(),r()}),h.open()}),T("body").on("click",".tpl-uploader .tpl-closer",function(){var t=T(this).parent().find(".tpl-uploaded-image"),e=t.closest(".tpl-field");t.attr("src",""),e.find(".tpl-img-placeholder").show(),e.find(".tpl-uploaded-image").hide(),T(this).closest(".tpl-field").find(".tpl-img_id").val("").trigger("change"),T(this).hide(),r()});var f={width:258,change:function(t,e){T(this).val(T(this).wpColorPicker("color")),c(),r()}};if(T(".tpl-color-field").focus(function(){T(this).wpColorPicker(f)}),T(".tpl-color-field").each(function(){T(this).focus()}),T(".handlediv").click(function(){T(this).closest(".postbox").not("closed").find(".tpl-color-field").wpColorPicker(f)}),n(),T("body").on("change",".tpl-dt-font_awesome select",function(){var t=T(this).select2("data")[0].text.match(/ data-type="([^"]*)"/);T(this).closest(".tpl-field").find("[data-preview=3]").html(t[1])}),T("body").on("change",".tpl-dt-post select",function(){if(""==T(this).val())T(this).closest(".tpl-datatype-container").find(".tpl-edit-icon").addClass("tpl-admin-hide"),T(this).closest(".tpl-datatype-container").find(".tpl-new-icon").removeClass("tpl-admin-hide");else{var t=T(this).closest(".tpl-datatype-container").attr("data-edit-url-template").replace("%d",T(this).val());T(this).closest(".tpl-datatype-container").find(".tpl-new-icon").addClass("tpl-admin-hide"),T(this).closest(".tpl-datatype-container").find(".tpl-edit-icon").attr("href",t).removeClass("tpl-admin-hide")}}),T("body").on("click",".tpl-dt-post .tpl-template-add-icon",function(t){t.preventDefault();var e=T(this).closest(".tpl-field").attr("data-name"),a=T(this).closest(".tpl-field").find("select");T.ajax({type:"post",dataType:"json",url:TPL_Admin.ajaxurl,data:{action:"tpl_create_post",option_name:e,_wpnonce:TPL_Admin.ajax_nonce},success:function(t){if(1==t.success){var e={id:t.post_id,text:t.select_label},i=new Option(e.text,e.id,!1,!1);a.append(i).trigger("change"),a.val(e.id).trigger("change")}}})}),T("body").on("click",".tpl-dt-select .tpl-refresh-icon",function(t){t.preventDefault();var e=T(this).closest(".tpl-field").attr("data-name"),i=T(this).attr("data-refresh"),a=T(this).closest(".tpl-field").find("select"),n=T(this);n.addClass("fa-spin"),T.ajax({type:"post",dataType:"json",url:TPL_Admin.ajaxurl,data:{action:i,option_name:e,_wpnonce:TPL_Admin.ajax_nonce},success:function(t){T.each(t,function(t,e){if(!a.find('option[value="'+t+'"]').length){var i=new Option(e,t,!1,!1);a.append(i)}})},complete:function(){n.removeClass("fa-spin")}})}),T("body").on("click",".tpl-editor-switch-buttons-wrap button",function(t){t.preventDefault();var e=T(this).closest(".tpl-field.tpl-dt-tinymce").find("textarea").attr("id");if(T(this).hasClass("tpl-editor-visual-button")){tinyMCE.execCommand("mceAddEditor",!1,e);e=T(this).closest(".tpl-field.tpl-dt-tinymce").find("textarea").css("visibility","hidden")}if(T(this).hasClass("tpl-editor-text-button")){tinyMCE.execCommand("mceRemoveEditor",!1,e);e=T(this).closest(".tpl-field.tpl-dt-tinymce").find("textarea").css("visibility","visible")}}),void 0!==T.datepicker&&T("body").on("focus",".tpl-field.tpl-dt-date input.tpl-date-field",function(){T(this).datepicker({dateFormat:"yy-mm-dd",firstDay:TPL_Admin.date_starts_with})}),T("body").on("click",".tpl-field.tpl-dt-boolean label",function(){var t=parseInt(T("input",this).val());if(1==t)var e=0;if(0==t||isNaN(t))e=1;T("input",this).val(e).trigger("change"),T(this).attr("class","checked-"+e)}),T("body").on("click",".tpl-admin-question",function(){T(".tpl-admin-subitem-desc",this).toggleClass("tpl-admin-hide")}),T("body").click(function(t){T(t.target).hasClass("tpl-admin-question")||T(".tpl-admin-subitem-desc").addClass("tpl-admin-hide")}),T("body").on("click","button.tpl-repeat-add",function(t){t.preventDefault();var e,i,a=tpl_fw.repeat_get_container(T(this));e=a,i=T(this).attr("data-for"),T("#tpl_repeater_bank .tpl-field[data-name='"+i+"']").clone().insertBefore(e.find(".tpl-repeat-button-container")),o(e),l(),c(),0<T(".tpl-dt-color",e).length&&T(".tpl-color-field",e).wpColorPicker(f),n(),T(".tpl-dt-font_awesome select",e).trigger("change"),s(),r()}),T("body").on("click",".tpl-remover",function(){var t,e;t=T(this),e=T(t).closest(".tpl-repeater"),1==confirm(TPL_Admin.remover_confirm_text)&&(T(t).closest(".tpl-field").remove(),o(e))}),T("body").on("click",".tpl-toggle-close",function(){T(this).closest(".tpl-repeat").children(".tpl-field-inner").addClass("tpl-admin-hide"),T(this).closest(".tpl-repeat-header").addClass("tpl-repeat-header-closed"),T(this).attr("title",TPL_Admin.repeat_maximize),T(this).removeClass("tpl-toggle-close"),T(this).addClass("tpl-toggle-open")}),T("body").on("click",".tpl-toggle-open",function(){T(this).closest(".tpl-repeat").children(".tpl-field-inner").removeClass("tpl-admin-hide"),T(this).closest(".tpl-repeat-header").removeClass("tpl-repeat-header-closed"),T(this).attr("title",TPL_Admin.repeat_minimize),T(this).addClass("tpl-toggle-close"),T(this).removeClass("tpl-toggle-open"),T(this).closest(".tpl-repeat").find(".tpl-color-field").focus()}),T(window).load(function(){tpl_fw.is_section_primary()&&T(".tpl-repeat-button-container").each(function(){T(this).closest("td").hasClass("tpl-repeater")||T(this).closest("td").addClass("tpl-repeater");var t=T(this).attr("data-connected");void 0!==t&&!1!==t&&T(this).closest("tr").attr("data-connected",T(this).attr("data-connected"))}),r(),c(),"undefined"!=typeof tinyMCE&&s()}),void 0!==T.ui.tabs)if(T("#tpl-settings-tabs").tabs(),"undefined"!==window.location.hash&&""!=window.location.hash)T("#tpl-settings-tabs").tabs("option","active",window.location.hash);else if("undefined"!=typeof Storage&&0!=T("#tpl-settings-tabs").length){var m=T("#tpl-settings-tabs").attr("data-store"),u=sessionStorage.getItem(m);void 0!==u&&T("#tpl-settings-tabs").tabs("option","active",u),T("#tpl-settings-tabs .nav-tab").click(function(){var t=T("#tpl-settings-tabs").attr("data-store"),e=T("#tpl-settings-tabs").tabs("option","active");sessionStorage.setItem(t,e)})}T("body").on("change","select, input, textarea",function(){c(),r()}),T("body").on("keyup","input, textarea",function(){T(this).val().length<2&&c()})});var tpl_fw={};jQuery(function(t){tpl_fw.is_section_primary=function(){var t=window.location.href;return-1<t.indexOf("themes.php")||-1<t.indexOf("options-general.php")||-1<t.indexOf("admin.php")?1:-1<t.indexOf("post.php")||-1<t.indexOf("post-new.php")?0:-1},tpl_fw.repeat_get_container=function(t){var e=tpl_fw.is_section_primary();if(-1<e){if(1==e)var i=t.closest(".tpl-repeater");else 0==e&&(i=t.closest(".tpl-meta-option-wrapper"));return i}}});